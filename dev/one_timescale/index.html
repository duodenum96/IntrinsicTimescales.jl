<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>One Timescale Model · IntrinsicTimescales.jl</title><meta name="title" content="One Timescale Model · IntrinsicTimescales.jl"/><meta property="og:title" content="One Timescale Model · IntrinsicTimescales.jl"/><meta property="twitter:title" content="One Timescale Model · IntrinsicTimescales.jl"/><meta name="description" content="Documentation for IntrinsicTimescales.jl."/><meta property="og:description" content="Documentation for IntrinsicTimescales.jl."/><meta property="twitter:description" content="Documentation for IntrinsicTimescales.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../home/">IntrinsicTimescales.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../home/">Getting Started</a></li><li><span class="tocitem">Practice</span><ul><li><a class="tocitem" href="../practice/practice_intro/">Practice</a></li><li><a class="tocitem" href="../practice/practice_1_acf/">Building the Autocorrelation Function</a></li><li><a class="tocitem" href="../practice/practice_2_acw/">Autocorrelation Windows</a></li><li><a class="tocitem" href="../practice/practice_3_ou/">Ornstein-Uhlenbeck Process as a Generative Model for ACF (Or Mommy, Where Do the ACFs Come From?)</a></li><li><a class="tocitem" href="../practice/practice_4_psd/">Dealing with Oscillatory Artifacts using Fourier Transformation</a></li></ul></li><li><a class="tocitem" href="../theory/theory/">Theory</a></li><li><span class="tocitem">Implementation</span><ul><li><a class="tocitem" href="../acw/">Model-Free Timescale Estimation</a></li><li><input class="collapse-toggle" id="menuitem-4-2" type="checkbox" checked/><label class="tocitem" for="menuitem-4-2"><span class="docs-label">Simulation Based Timescale Estimation</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../simbasedinference/">Overview</a></li><li class="is-active"><a class="tocitem" href>One Timescale Model</a><ul class="internal"><li><a class="tocitem" href="#ACF-Summary"><span>ACF Summary</span></a></li><li><a class="tocitem" href="#PSD-Summary"><span>PSD Summary</span></a></li><li><a class="tocitem" href="#Returns"><span>Returns</span></a></li></ul></li><li><a class="tocitem" href="../one_timescale_with_missing/">One Timescale Model with Missing Data</a></li><li><a class="tocitem" href="../one_timescale_and_osc/">One Timescale Model with Oscillations</a></li><li><a class="tocitem" href="../one_timescale_and_osc_with_missing/">One Timescale Model with Oscillations and Missing Data</a></li><li><a class="tocitem" href="../fit_parameters/">Model Fitting and Parameters</a></li><li><a class="tocitem" href="../fit_result/">Results</a></li></ul></li></ul></li><li><a class="tocitem" href="../">API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Implementation</a></li><li><a class="is-disabled">Simulation Based Timescale Estimation</a></li><li class="is-active"><a href>One Timescale Model</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>One Timescale Model</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/duodenum96/IntrinsicTimescales.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/duodenum96/IntrinsicTimescales.jl/blob/master/docs/src/one_timescale.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="one_timescale"><a class="docs-heading-anchor" href="#one_timescale">One Timescale Model (<code>one_timescale_model</code>)</a><a id="one_timescale-1"></a><a class="docs-heading-anchor-permalink" href="#one_timescale" title="Permalink"></a></h1><p>The generative model:</p><p class="math-container">\[\frac{dx}{dt} = -\frac{x}{\tau} + \xi(t)\]</p><p>with timescale <span>$\tau$</span>. <span>$\xi(t)$</span> is white noise with unit variance. </p><p>Can be used with either ACF or PSD as the summary method. </p><h2 id="ACF-Summary"><a class="docs-heading-anchor" href="#ACF-Summary">ACF Summary</a><a id="ACF-Summary-1"></a><a class="docs-heading-anchor-permalink" href="#ACF-Summary" title="Permalink"></a></h2><pre><code class="language-julia hljs">function one_timescale_model(data, time, fit_method; summary_method=:acf,
                             prior=nothing, n_lags=nothing,
                             distance_method=nothing,
                             dims=ndims(data), distance_combined=false,
                             weights=[0.5, 0.5])</code></pre><p>Simple usage:</p><pre><code class="language-julia hljs">model = one_timescale_model(data, time, :abc, summary_method=:acf)
results = fit(model)
int = results.MAP[1] # maximum a posteriori estimate</code></pre><h4 id="Mandatory-arguments:"><a class="docs-heading-anchor" href="#Mandatory-arguments:">Mandatory arguments:</a><a id="Mandatory-arguments:-1"></a><a class="docs-heading-anchor-permalink" href="#Mandatory-arguments:" title="Permalink"></a></h4><ul><li><code>data</code>: Your time-series data as a vector or 2-dimensional array. </li></ul><p>If it is n-dimensional, by default, the dimension of time is assumed to be the last dimension. If this is not the case, you can set it via <code>dims</code> argument, similar to <a href="../acw/"><code>acw</code></a> function. The other dimension should correspond to trials. IntrinsicTimescales.jl calculates one ACF from each trial and averages them to get a less noisy ACF estimate. If the user wants to calculate one INT per trial, they can run a for-loop over trials. </p><ul><li><p><code>time</code>: Time points corresponding to the data. </p></li><li><p><code>fit_method</code>: <code>:abc</code> or <code>:advi</code>. Method to use for parameter estimation. </p></li></ul><h4 id="Optional-arguments:"><a class="docs-heading-anchor" href="#Optional-arguments:">Optional arguments:</a><a id="Optional-arguments:-1"></a><a class="docs-heading-anchor-permalink" href="#Optional-arguments:" title="Permalink"></a></h4><ul><li><code>summary_method</code>: <code>:acf</code>. Method to use for summary statistics. </li></ul><p>If <code>:acf</code>, calculates the autocorrelation function using <code>comp_ac_fft</code> internally. If <code>:psd</code>, calculates the power spectral density using <code>comp_psd</code>. </p><ul><li><code>prior</code>: Prior distribution for the parameters. <code>&quot;informed_prior&quot;</code> or a Distribution object from <a href="https://juliastats.org/Distributions.jl/stable/">Distributions.jl</a>. </li></ul><p>If the user does not specify a prior, or specifies <code>&quot;informed_prior&quot;</code>, IntrinsicTimescales.jl uses a normal distribution with mean determined by fitting an exponential decay to the autocorrelation function using <code>fit_expdecay</code> and standard deviation of 20. Currently we recommend explicitly specifying a prior distribution to improve the accuracy of the inference. </p><p>An example for custom prior distribution:</p><pre><code class="language-julia hljs">prior = Normal(100.0, 10.0)
results = one_timescale_model(data, time, :abc, summary_method=:acf, prior=prior)</code></pre><ul><li><code>n_lags</code>: Number of lags to use for the ACF calculation. </li></ul><p>By default, this is set to <code>1.1*acw0</code>. The reason for cutting the autocorrelation function is due to increased measurement noise for autocorrelation function for later lags. Intuitively, when we perform correlation of a time-series with a shifted version of itself, we have less and less number of time points to calculate the correlation. This is why if you plot the autocorrelation function, the portion of it after ACW-0 looks more noisy. For more details, see [Practice 1]. </p><ul><li><code>distance_method</code>: <code>:linear</code> or <code>:logarithmic</code>. </li></ul><p>Method to use for distance calculation. <code>:linear</code> is RMSE between the ACF from data and the model ACF whereas <code>:logarithmic</code> is RMSE after log-transforming the ACF. The default is <code>:linear</code>. </p><ul><li><code>distance_combined</code>: <code>true</code> or <code>false</code>. </li></ul><p>If <code>true</code>, the distance is a weighted sum of RMSE between ACFs and RMSE between exponential decay fits to ACFs. Defaults to <code>false</code>.</p><ul><li><code>weights</code>: A vector of two numbers. </li></ul><p>The first number is the weight for RMSE between ACFs and the second number is the weight for RMSE between exponential decay fits to ACFs. The default is <code>[0.5, 0.5]</code>. Used only if <code>distance_combined</code> is <code>true</code>. </p><h2 id="PSD-Summary"><a class="docs-heading-anchor" href="#PSD-Summary">PSD Summary</a><a id="PSD-Summary-1"></a><a class="docs-heading-anchor-permalink" href="#PSD-Summary" title="Permalink"></a></h2><pre><code class="language-julia hljs">function one_timescale_model(data, time, fit_method; summary_method=:psd,
                             prior=nothing, 
                             distance_method=nothing, freqlims=nothing,
                             dims=ndims(data), distance_combined=false,
                             weights=[0.5, 0.5])</code></pre><p>Simple usage:</p><pre><code class="language-julia hljs">model = one_timescale_model(data, time, :abc, summary_method=:psd)
results = fit(model)
int = results.MAP[1]</code></pre><p>There are two arguments that are different from the ACF summary:</p><ul><li><code>summary_method</code>: <code>:psd</code>. Method to use for summary statistics. </li></ul><p>Calculates the power spectral density using <code>comp_psd</code>. </p><ul><li><code>freqlims</code>: A tuple of two numbers. </li></ul><p>The first number is the lower frequency limit and the second number is the upper frequency limit used to index the power spectral density. The default is the output from <a href="https://juliamath.github.io/AbstractFFTs.jl/stable/api/#AbstractFFTs.fftfreq"><code>fftfreq</code></a> function of <a href="https://juliamath.github.io/AbstractFFTs.jl/stable/">AbstractFFTs.jl</a> library. </p><h4 id="Implementation-differences-from-ACF-Summary"><a class="docs-heading-anchor" href="#Implementation-differences-from-ACF-Summary">Implementation differences from ACF Summary</a><a id="Implementation-differences-from-ACF-Summary-1"></a><a class="docs-heading-anchor-permalink" href="#Implementation-differences-from-ACF-Summary" title="Permalink"></a></h4><ul><li><p><code>prior</code>: <code>&quot;informed_prior&quot;</code> fits a lorentzian to the PSD and calculates the INT from the knee frequency using <code>tau_from_knee</code> and <code>find_knee_frequency</code>. </p></li><li><p><code>distance_method</code>: <code>:linear</code> is RMSE between the PSD from data and the model PSD whereas <code>:logarithmic</code> is RMSE after log-transforming the PSD. The default is <code>:linear</code>. </p></li><li><p><code>distance_combined</code>: Weighted sum between RMSE between PSDs and RMSE between INT estimates from knee frequency obtained from lorentzian fits to PSD. </p></li><li><p><code>weights</code>: A vector of two numbers. </p></li></ul><p>The first number is the weight for RMSE between PSDs and the second number is the weight for RMSE between INT estimates. </p><h2 id="Returns"><a class="docs-heading-anchor" href="#Returns">Returns</a><a id="Returns-1"></a><a class="docs-heading-anchor-permalink" href="#Returns" title="Permalink"></a></h2><ul><li><code>model</code>: A <code>OneTimescaleModel</code> object. Can be used as an input to <code>fit</code> function to estimate INT and <code>posterior_predictive</code> function to plot posterior predictive check. </li></ul></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../simbasedinference/">« Overview</a><a class="docs-footer-nextpage" href="../one_timescale_with_missing/">One Timescale Model with Missing Data »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.8.0 on <span class="colophon-date" title="Wednesday 19 February 2025 01:40">Wednesday 19 February 2025</span>. Using Julia version 1.11.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
